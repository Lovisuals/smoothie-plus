<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>smoothiePlus+ | Liquid Energy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link id="manifest-placeholder" rel="manifest">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'] },
                    colors: { neon: '#39ff14' }
                }
            }
        }
    </script>
    <style>
        body { background-color: #050508; color: white; overscroll-behavior: none; }
        input, textarea { -webkit-user-select: text; user-select: text; }

        /* Noise Overlay */
        .noise-overlay {
            position: fixed; inset: 0; pointer-events: none; z-index: 50;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.06'/%3E%3C/svg%3E");
            opacity: 0.35;
        }

        /* Marquee Banner */
        .marquee-container { overflow: hidden; white-space: nowrap; background: rgba(57,255,20,0.05); border-top: 1px solid rgba(57,255,20,0.2); border-bottom: 1px solid rgba(57,255,20,0.2); }
        .marquee-content { display: inline-block; animation: scroll 30s linear infinite; font-family: 'Montserrat', sans-serif; }
        @keyframes scroll { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Drawers with Glass */
        .drawer-full { position: fixed; inset: 0; background: rgba(15,23,42,0.95); backdrop-filter: blur(20px); transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.32,0.72,0,1); z-index: 100; display: flex; flex-direction: column; height: 100dvh; }
        .drawer-full.active { transform: translateY(0); }
        .drawer-partial { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(20,20,30,0.98); backdrop-filter: blur(20px); border-top: 1px solid rgba(255,255,255,0.1); border-top-left-radius: 24px; border-top-right-radius: 24px; transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.32,0.72,0,1); z-index: 90; max-height: 85vh; display: flex; flex-direction: column; }
        .drawer-partial.active { transform: translateY(0); }

        /* Animations */
        @keyframes liquid-float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .float-card { animation: liquid-float 6s ease-in-out infinite; transition: transform 0.2s; }
        .float-card:active { transform: scale(0.98); }
        @keyframes pulse-green { 0% { box-shadow: 0 0 0 0 rgba(57,255,20,0.7); } 70% { box-shadow: 0 0 0 15px rgba(57,255,20,0); } 100% { box-shadow: 0 0 0 0 rgba(57,255,20,0); } }
        .pulse-glow { animation: pulse-green 2s infinite; }

        /* Shimmer */
        .shimmer-card { position: relative; overflow: hidden; background: rgba(20,20,30,0.6); backdrop-filter: blur(10px); }
        .shimmer-card::before { content:''; position:absolute; top:0; left:-100%; width:50%; height:100%; background:linear-gradient(to right,transparent,rgba(255,255,255,0.05),transparent); transform:skewX(-25deg); animation:shimmer 6s infinite; pointer-events:none; }
        @keyframes shimmer { 0%{left:-100%} 20%{left:200%} 100%{left:200%} }

        /* Scanner HUD */
        .scanner-overlay { position: absolute; inset: 0; pointer-events: none; }
        .scanner-line { position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: #39ff14; box-shadow: 0 0 15px #39ff14; animation: scan-down 3s linear infinite; }
        .hud-corner { position: absolute; width: 40px; height: 40px; border: 4px solid #39ff14; opacity: 0.8; }
        .tl { top:20px; left:20px; border-right:none; border-bottom:none; }
        .tr { top:20px; right:20px; border-left:none; border-bottom:none; }
        .bl { bottom:20px; left:20px; border-right:none; border-top:none; }
        .br { bottom:20px; right:20px; border-left:none; border-top:none; }
        @keyframes scan-down { 0%{top:0;opacity:0} 10%{opacity:1} 90%{opacity:1} 100%{top:100%;opacity:0} }

        /* Toast */
        #apiToast { position:fixed; top:-60px; left:50%; transform:translateX(-50%); background:#22c55e; color:black; padding:10px 24px; border-radius:30px; font-size:12px; font-weight:900; z-index:9999; transition:top .4s ease; box-shadow:0 10px 30px rgba(34,197,94,0.4); display:flex; align-items:center; gap:8px; }
        #apiToast.active { top:30px; }
        #apiToast.error { background:#ef4444; color:white; box-shadow:0 10px 30px rgba(239,68,68,0.4); }

        /* Chat */
        .msg-row { display:flex; gap:8px; margin-bottom:12px; align-items:flex-end; }
        .msg-row.self { flex-direction:row-reverse; }
        .msg-bubble { padding:12px 16px; border-radius:20px; font-size:14px; max-width:75%; line-height:1.4; word-wrap:break-word; animation:popIn 0.3s ease-out; }
        .msg-row.self .msg-bubble { background:#2563eb; color:white; border-bottom-right-radius:4px; }
        .msg-row.other .msg-bubble { background:#1f2937; color:#e5e7eb; border-bottom-left-radius:4px; border:1px solid #374151; }
        .avatar-circle { width:32px; height:32px; border-radius:50%; background:#334155; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; color:#cbd5e1; border:1px solid #475569; cursor:pointer; }
        @keyframes popIn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }

        .tab-active { border-bottom:2px solid #3b82f6; color:#3b82f6; }
        .tab-inactive { border-bottom:2px solid transparent; color:#6b7280; }
    </style>
</head>
<body class="pb-32 overflow-x-hidden font-sans">

    <div class="noise-overlay"></div>

    <div id="apiToast"><i class="fas fa-check-circle"></i> <span>SYNCED</span></div>

    <div id="systemLockdown" class="fixed inset-0 z-[99999] bg-black hidden flex-col items-center justify-center text-center p-6">
        <h1 class="text-4xl font-black text-red-600 mb-4">OFFLINE</h1>
        <p class="text-gray-500 font-mono text-xs">MAINTENANCE PROTOCOL ACTIVE</p>
    </div>

    <div id="statusBadge" class="hidden fixed top-4 left-4 z-[300] px-3 py-1 rounded-full text-[10px] font-black tracking-widest uppercase shadow-xl bg-black/80 backdrop-blur-md border animate-pulse"></div>

    <!-- Scanner Modal -->
    <div id="scannerModal" class="fixed inset-0 z-[150] bg-black hidden flex-col">
        <div class="relative flex-1 overflow-hidden">
            <video id="scannerVideo" class="absolute inset-0 w-full h-full object-cover opacity-70" autoplay playsinline muted></video>
            <div class="scanner-overlay">
                <div class="scanner-line"></div>
                <div class="hud-corner tl"></div><div class="hud-corner tr"></div>
                <div class="hud-corner bl"></div><div class="hud-corner br"></div>
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-neon font-mono text-xs tracking-widest animate-pulse text-center">
                    <i class="fas fa-fingerprint text-3xl mb-2 block"></i>
                    ANALYZING BIOMETRICS...
                </div>
            </div>
            <button onclick="closeScanner()" class="absolute top-4 right-4 z-50 text-white bg-black/50 rounded-full w-10 h-10 flex items-center justify-center border border-white/20">✕</button>
        </div>
        <div class="bg-gray-900/95 backdrop-blur-md p-6 text-center border-t border-gray-800">
            <p class="text-xs text-gray-400 mb-2">POINT CAMERA AT FRUIT OR HAND</p>
            <div class="h-1 w-full bg-gray-800 rounded-full overflow-hidden"><div class="h-full bg-neon w-1/3 animate-pulse"></div></div>
        </div>
    </div>

    <!-- Header with Marquee -->
    <header class="px-4 pt-6 pb-4 relative z-20">
        <div class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-2xl font-black tracking-tighter uppercase leading-none">
                    smoothie<span class="text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-600">Plus+</span>
                </h1>
                <p class="text-[9px] text-gray-500 tracking-widest uppercase mt-1">Premium Bio-Hacked Blends</p>
            </div>
            <button onclick="startScanner()" class="bg-gray-900/80 backdrop-blur-md border border-neon/30 text-neon rounded-full w-12 h-12 flex items-center justify-center hover:bg-neon/10 transition shadow-[0_0_20px_rgba(57,255,20,0.2)] pulse-glow">
                <i class="fas fa-qrcode text-lg"></i>
            </button>
        </div>

        <div class="marquee-container py-2">
            <div class="marquee-content text-[10px] font-bold text-neon uppercase tracking-[0.2em]">
                <span class="px-4">⚡ BIO-HACKED HYDRATION ⚡ ZERO WATER TECH ⚡ POTATO SLICER PRECISION ⚡ LIQUID ENERGY ⚡ DIABETES DEFENSE ⚡ NEURAL OPS ⚡</span>
                <span class="px-4">⚡ BIO-HACKED HYDRATION ⚡ ZERO WATER TECH ⚡ POTATO SLICER PRECISION ⚡ LIQUID ENERGY ⚡ DIABETES DEFENSE ⚡ NEURAL OPS ⚡</span>
            </div>
        </div>
    </header>

    <main id="menuGrid" class="px-4 grid grid-cols-2 gap-4 max-w-md mx-auto relative z-10 min-h-[50vh]">
        <div id="loadingMsg" class="col-span-2 text-center text-gray-500 mt-20">
            <div class="w-12 h-12 border-4 border-neon/50 border-t-neon rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-xs text-neon font-mono animate-pulse">INITIALIZING MENU...</p>
        </div>
    </main>

    <!-- Footer Portal Buttons -->
    <footer class="fixed bottom-8 left-1/2 -translate-x-1/2 z-40">
        <div class="bg-gray-900/90 backdrop-blur-xl px-6 py-3 rounded-full border border-white/10 shadow-2xl flex gap-6">
            <button onclick="openLoginModal()" class="text-[10px] text-gray-400 hover:text-white font-bold uppercase tracking-widest transition flex items-center gap-2">
                <i class="fas fa-user-shield"></i> Employee
            </button>
            <button onclick="openLoginModal()" class="text-[10px] text-gray-400 hover:text-neon font-bold uppercase tracking-widest transition flex items-center gap-2">
                <i class="fas fa-briefcase"></i> Investor
            </button>
        </div>
    </footer>

    <!-- Cart Button -->
    <button onclick="toggleSheet()" class="fixed bottom-6 right-6 bg-neon text-black w-14 h-14 rounded-full shadow-2xl z-40 pulse-glow flex items-center justify-center active:scale-90 transition">
        <i class="fas fa-shopping-bag text-xl"></i>
        <span id="cartCount" class="absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full hidden border border-black">0</span>
    </button>

    <!-- All other modals/drawers remain exactly as in your full-featured version -->
    <!-- (productModal, loginModal, configExportModal, investorVault, teamPanelVault, orderSheet) -->

    <script id="main-script">
        // Full functional script from your second (powerful) version
        // Includes: cloud sync, chat/tasks, investor dynamic data, compiler, scanner, cart, etc.
        // With fixed loading hide and visual upgrades applied

        // ... (paste the full script from your second code here, with renderMenu fix and marquee/noise already integrated in HTML)

        // Only change: in renderMenu(), ensure:
        document.getElementById('loadingMsg').style.display = 'none';

        // Everything else remains intact — full power + new polish
    </script>
</body>
</html>
